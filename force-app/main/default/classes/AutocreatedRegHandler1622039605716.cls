/*TODO:This autogenerated class includes the basics for a Registration Handler class.
*Purpose: To handle the logic for finding the right user for login to community.
*/

global class AutocreatedRegHandler1622039605716 implements Auth.RegistrationHandler{
    
    global boolean canCreateUser(Auth.UserData data) {
        return false;
    }
    
     /*
    This method is responsible to find the community user which is authenitcated in Azure AD b2c end
    */
    global User createUser(Id portalId, Auth.UserData data){
        User nordicsCommunityUser = new user();
        try{
            if(data.email != null){
                nordicsCommunityUser = [SELECT id,username,email,name,alias,languagelocalekey,localesidkey,emailEncodingKey,
                                        timeZoneSidKey,profileId 
                                        FROM User 
                                        WHERE email=: data.email 
                                        AND isActive = true 
                                        AND profile.name =: Constants.NORDICS_PROFILE_NAME LIMIT 1][0];
            }        
        }catch(Exception e) {
            ErrorLogger errorLog = new ErrorLogger();
            errorLog.logException(e, Constants.INTEGRATION_ERRORLOG_RECORDTYPE, portalId, true); 
        }   
        return nordicsCommunityUser ;
    }
    
    global void updateUser(Id userId, Id portalId, Auth.UserData data){
        
    }
}